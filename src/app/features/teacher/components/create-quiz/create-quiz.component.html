<div class="fixed inset-0 backdrop-blur-sm bg-black/40 flex items-center justify-center z-50">
  <div
    class="bg-white w-full max-w-3xl p-6 rounded-lg shadow-xl overflow-y-auto max-h-[90vh] relative transition-transform duration-300"
  >
    <!-- Close Button -->
    <button
      class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl font-bold"
      (click)="closeModal()"
    >
      Ã—
    </button>

    <h2 class="text-2xl font-semibold mb-6 text-center">
      {{ isEditMode ? (isDisabled ? 'View Quiz' : 'Edit Quiz') : 'Create Quiz' }}
    </h2>

    <form [formGroup]="quizForm" class="space-y-4">
      <!-- Course -->
      <div>
        <label class="block text-sm font-medium mb-1">Course</label>
        <select formControlName="course" class="w-full border rounded-md p-2">
          <option value="">Select a course</option>
          <option *ngFor="let c of courses" [value]="c">{{ c }}</option>
        </select>
      </div>

      <!-- Quiz Number -->
      <div>
        <label class="block text-sm font-medium mb-1">Quiz Number</label>
        <input
          type="text"
          formControlName="quizNo"
          class="w-full border rounded-md p-2"
          placeholder="Enter quiz number"
        />
      </div>

      <!-- Due Date -->
      <div>
        <label class="block text-sm font-medium mb-1">Due Date</label>
        <input type="date" formControlName="dueDate" class="w-full border rounded-md p-2" />
      </div>

      <!-- Description -->
      <div>
        <label class="block text-sm font-medium mb-1">Description (optional)</label>
        <textarea
          formControlName="description"
          class="w-full border rounded-md p-2"
          rows="3"
          placeholder="Enter quiz description"
        ></textarea>
      </div>

      <!-- Questions -->
      <div formArrayName="questions" class="space-y-4">
        <div
          *ngFor="let q of questions.controls; let i = index"
          [formGroupName]="i"
          class="border p-4 rounded-lg bg-gray-50 shadow-sm"
        >
          <label class="font-semibold mb-2 block">Question {{ i + 1 }}</label>
          <input
            type="text"
            formControlName="statement"
            class="w-full border rounded-md p-2 mb-3"
            placeholder="Enter question statement"
          />

          <!-- Options -->
          <div formArrayName="options" class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <div *ngFor="let opt of getOptions(i).controls; let j = index">
              <input
                type="text"
                [formControlName]="j"
                class="w-full border rounded-md p-2"
                placeholder="Option {{ j + 1 }}"
              />
            </div>
          </div>

          <!-- Correct Answer -->
          <div class="mt-3">
            <label class="text-sm font-medium mb-1 block">Correct Answer</label>
            <input
              type="text"
              formControlName="correctAnswer"
              class="w-full border rounded-md p-2"
              placeholder="Enter correct answer"
            />
          </div>

          <!-- Remove -->
          <button
            type="button"
            *ngIf="!isDisabled && questions.length > 1"
            (click)="removeQuestion(i)"
            class="text-red-600 text-sm mt-2"
          >
            Remove Question
          </button>
        </div>
      </div>

      <!-- Add Question -->
      <div *ngIf="!isDisabled" class="flex justify-start mt-4">
        <button
          type="button"
          (click)="addQuestion()"
          class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-md font-medium"
        >
          + Add Another Question
        </button>
      </div>

      <!-- Footer Buttons -->
      <div class="flex justify-end space-x-3 mt-8">
        <button
          type="button"
          class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-md"
          (click)="closeModal()"
        >
          Cancel
        </button>

        <button
          type="button"
          *ngIf="!isDisabled"
          class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md"
          (click)="saveQuiz()"
        >
          {{ isEditMode ? 'Update Quiz' : 'Generate Quiz' }}
        </button>
      </div>
    </form>
  </div>
</div>
