<div class="fixed inset-0 backdrop-blur-sm bg-black/40 flex items-center justify-center z-50">
  <div
    class="bg-white w-full max-w-3xl p-6 rounded-lg shadow-xl overflow-y-auto max-h-[90vh] relative transition-transform duration-300"
  >
    <!-- Close Button -->
    <button
      class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl font-bold"
      (click)="closeModal()"
    >
      Ã—
    </button>

    <h2 class="text-2xl font-semibold mb-6 text-center">
      {{ viewOnly ? 'Quiz Results' : 'Take Quiz' }}
    </h2>

    <div *ngIf="quizForm" [formGroup]="quizForm" class="space-y-4">
      <!-- Quiz Info -->
      <div>
        <p class="text-gray-600"><strong>Course:</strong> {{ quiz.course }}</p>
        <p class="text-gray-600"><strong>Quiz No:</strong> {{ quiz.quizNo }}</p>
        <p class="text-gray-600"><strong>Description:</strong> {{ quiz.description }}</p>
      </div>

      <!-- Questions -->
      <div formArrayName="questions" class="space-y-4">
        <div
          *ngFor="let q of questions.controls; let i = index"
          [formGroupName]="i"
          class="border p-4 rounded-lg bg-gray-50 shadow-sm"
        >
          <p class="font-semibold mb-2">
            Question {{ i + 1 }}: {{ q.value.statement }}
          </p>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <label
              *ngFor="let opt of q.value.options"
              class="flex items-center space-x-2 border rounded-md p-2 transition"
              [ngClass]="getResultClass(q, opt)"
            >
              <input
                type="radio"
                [formControlName]="'selectedAnswer'"
                [value]="opt"
                [disabled]="viewOnly"
              />
              <span>{{ opt }}</span>
            </label>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="flex justify-between items-center mt-6">
        <button
          type="button"
          class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-md"
          (click)="closeModal()"
        >
          {{ viewOnly ? 'Close' : 'Cancel' }}
        </button>

        <button
          *ngIf="!viewOnly && !submitted"
          type="button"
          class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md"
          (click)="submitQuiz()"
        >
          Submit Quiz
        </button>

        <div *ngIf="submitted" class="text-lg font-semibold text-blue-700">
          Your Score: {{ score }}/{{ questions.length }}
        </div>
      </div>
    </div>
  </div>
</div>
